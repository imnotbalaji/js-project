!function(){"use strict";var t,e,a;t=class{constructor(t,e,a){this.time_period=e,this.data=t.data,console.log(e),t.get_data().then((t=>{this.render_line(t,this.get_period(e),a)}))}get_period(t){switch(t){case"All":return 18250;case"10Y":return 3650;case"5Y":return 1825;case"2Y":return 730;case"1Y":return 365;case"6M":return 180;case"3M":return 90;case"1M":return 30}}render_line(t,e,a){console.log(e);const r=d3.timeFormat("%m-%y"),s=a.node().clientWidth,n=a.node().clientHeight,o=new Date,i=new Date,l=e;i.setDate(o.getDate()-l);const d=t.filter((t=>new Date(t.timestamp)>i));d.sort(((t,e)=>new Date(t.timestamp)-new Date(e.timestamp)));const p=d3.scaleTime().domain(d3.extent(d,(t=>new Date(t.timestamp)))).range([0,s]),c=d3.scaleLinear().domain([0,d3.max(d,(t=>t.value))]).range([n,0]),u=d3.line().x((t=>p(new Date(t.timestamp)))).y((t=>c(t.value)));if(a.select("#shadow").empty()){const t=a.append("defs").append("filter").attr("id","shadow");t.append("feOffset").attr("in","SourceGraphic").attr("dx",0).attr("dy",10).attr("result","offOut"),t.append("feGaussianBlur").attr("in","off0ut").attr("stdDeviation",15).attr("result","blurOut"),t.append("feBlend").attr("in","SourceGraphic").attr("in2","blurOut").attr("mode","normal")}let m=a.select("path");m.empty()&&(m=a.append("path").attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1).attr("filter","url(#shadow")),m.datum(d).attr("d",u);const h=m.node().getTotalLength();m.attr("stroke-dasharray",h+" "+h).attr("stroke-dashoffset",h),m.transition().duration(500).ease(d3.easeLinear).attr("stroke-dashoffset",0);const y=d3.axisBottom(p).tickFormat((t=>r(t)));d3.axisRight(c);let g=a.select(".x-axis");g.empty()&&(g=a.append("g").attr("class","x-axis").attr("transform","translate(0,"+n+")")),g.transition().duration(1e3).call(y);const x=a.append("circle").attr("r",5).attr("fill","red").style("display","none"),f=a.append("text").attr("dy","-1em").style("text-anchor","middle").style("display","none"),w=a.append("line").attr("stroke","grey").attr("stroke-width","1").attr("stroke-dasharray","5,5").style("display","none");a.on("mouseover",(function(){x.style("display",null),f.style("display",null),w.style("display",null)})).on("mousemove",(function(t){const[e,a]=d3.pointer(t),r=p.invert(e),s=(0,d3.bisector((t=>new Date(t.timestamp))).left)(d,r),n=d[s];x.attr("cx",p(new Date(n.timestamp))).attr("cy",c(n.value)),w.attr("x1",p(new Date(n.timestamp))).attr("x2",p(new Date(n.timestamp))).attr("y1",c(0)).attr("y2",c(n.value)),f.attr("x",p(new Date(n.timestamp))).attr("y",c(n.value)-10).text(n.value)})).on("mouseout",(function(){x.style("display","none"),f.style("display","none"),w.style("display","none")}))}},e=class{constructor(t){this.ticker=t,this.data=[30,80,45,60,121,90,15]}async get_data(){const t=(await d3.json("./test_data/IBM_daily_full.json"))["Time Series (Daily)"];return Object.keys(t).map((e=>({timestamp:e,value:parseFloat(t[e]["1. open"])})))}url_maker(){return"https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol="+this.ticker+"&outputsize=full&apikey=MHTLO8QSWV47YWUG"}generateRandomData(){const t=[],e=new Date;e.setHours(9,0,0,0);const a=new Date;a.setHours(17,0,0,0);for(let r=e;r<=a;r.setMinutes(r.getMinutes()+30)){const e=100*Math.random()+100;t.push({timestamp:r.toISOString(),value:e.toFixed(2)})}return t}},a=class{constructor(){const t=d3.select("#main");this.main=t,this.render(t)}render(t){t.style("height","500px").style("width","70%").style("border","none").style("border-radius","2%").style("background-color","white").style("box-shadow","5px 5px 10px rgba(0, 0, 0, 0.5)");const e=t.append("div").attr("id","search_container").attr("position","relative").append("input").attr("id","search-input").attr("placeholder","Search...").style("border","none").style("margin","20px 20px").style("font-size","20px").style("padding","10px 10px").style("text-transform","uppercase"),a=t.append("svg").style("margin","50px").attr("width","70%").attr("height","80%").style("overflow","visible");this.svg=a,e.on("keypress",this.handle_enter.bind(this))}async search_ticker(t){if(this.main,this.svg,"Enter"===t.key){d3.select(t.target).property("value");const e=d3.select("#search_container").append("div").attr("id","dropdown").attr("position","absolute").attr("overflow-y","auto").style("border","1px solid black");for(let t=0;t<10;t++){let a=e.append("div").attr("id",`div-${t}`);a.attr("value",t).text("Hello"+t).style("background-color","grey"),a.on("click",(()=>{d3.select("#search-input").property("value",t)}))}}}handle_click(t){console.log(t.value)}handle_enter(t){this.main;let a=this.svg;if("Enter"===t.key){const r=d3.select(t.target).property("value"),s=new e(r);this.render_chart(s,"All",a),this.show_zoom_buttons(s)}}render_chart(e,a,r){new t(e,a,r)}show_zoom_buttons(t){let e=this.main,a=this.svg;const r=["All","10Y","5Y","2Y","1Y","6M","3M","1M"];let s=r[0],n=e.select("#zoom");n.empty()&&(n=e.append("div").attr("id","zoom"),n.append("img").attr("id","zoom-out").attr("src","./images/zoom_out.png").attr("width","25px").attr("height","25px"),n.append("span").attr("id","zoom_text"),n.append("img").attr("id","zoom-in").attr("src","./images/zoom_in.png").attr("width","25px").attr("height","25px"));let o=d3.select("#zoom-out");d3.select("#zoom_text").text(s),o.on("click",(()=>{s=r[r.indexOf(s)-1],d3.select("#zoom_text").text(s),this.render_chart(t,s,a)})),d3.select("#zoom-in").on("click",(()=>{s=r[r.indexOf(s)+1],d3.select("#zoom_text").text(s),this.render_chart(t,s,a)}))}},document.addEventListener("DOMContentLoaded",(()=>{d3.select("body").style("background-image","url('./images/island.png')"),new a}))}();
//# sourceMappingURL=main.js.map