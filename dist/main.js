!function(){"use strict";var t,e,a;t=class{constructor(t,e,a){this.time_period=e,this.data=t.data,console.log(e),t.get_data().then((t=>{this.render_line(t,this.get_period(e),a)}))}get_period(t){switch(t){case"All":return 18250;case"10Y":return 3650;case"5Y":return 1825;case"2Y":return 730;case"1Y":return 365;case"6M":return 180;case"3M":return 90;case"1M":return 30}}render_line(t,e,a){console.log(e);const s=d3.timeFormat("%b-%y");console.log(0);const r=new Date,o=new Date,n=e;o.setDate(r.getDate()-n);const l=t.filter((t=>new Date(t.timestamp)>o));l.sort(((t,e)=>new Date(t.timestamp)-new Date(e.timestamp)));const i=l[0].value,d=l[l.length-1].value;let p;console.log(d),console.log(i),p=d>i?"green":"red";const c=d3.scaleTime().domain(d3.extent(l,(t=>new Date(t.timestamp)))).range([0,800]),y=d3.scaleLinear().domain([d3.min(l,(t=>t.value)),d3.max(l,(t=>t.value))]).range([400,0]),m=d3.line().x((t=>c(new Date(t.timestamp)))).y((t=>y(t.value)));if(a.select("#shadow").empty()){const t=a.append("defs").append("filter").attr("id","shadow").attr("x","0%").attr("y","-50%").attr("height","200%").attr("width","200%");t.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3).attr("result","blur"),t.append("feOffset").attr("in","blur").attr("dx",3).attr("dy",3).attr("result","offsetBlur");let e=t.append("feMerge");e.append("feMergeNode").attr("in","offsetBlur"),e.append("feMergeNode").attr("in","SourceGraphic")}if(a.select("#gradient").empty()){let t=a.select("defs").append("linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");t.append("stop").attr("offset","0%").attr("stop-color",p).attr("stop-opacity",.3),t.append("stop").attr("offset","100%").attr("stop-color",p).attr("stop-opacity",0)}a.select("#gradient").selectAll("stop").attr("stop-color",p);let u=d3.min(l,(t=>t.value)),h=d3.area().x((t=>c(new Date(t.timestamp)))).y1((t=>y(t.value))).y0(y(u));console.log(gradient);let g=a.select(".line-path"),x=a.select(".area-path");x.empty()&&(x=a.append("path").attr("class","area-path").style("fill","url(#gradient")),x.datum(l).attr("d",h),g.empty()&&(g=a.append("path").attr("class","line-path").attr("fill","none").attr("stroke",p).attr("stroke-width",.7)),a.select(".line-path").attr("stroke",p),g.datum(l).attr("d",m),g.attr("opacity",0).transition().duration(500).ease(d3.easeLinear).attr("opacity",1);const w=d3.axisBottom(c).tickFormat((t=>s(t)));let f=d3.max(l,(t=>t.value)),b=(f-u)/4,v=[u,u+b,u+2*b,u+3*b,f],_=[u+b,u+2*b,u+3*b,f];const k=d3.axisRight(y).tickValues(v);let D=a.select(".x-axis");D.empty()&&(D=a.append("g").attr("class","x-axis").attr("transform","translate(0,400)")),D.transition().duration(1e3).call(w);let z=a.select(".y-axis");z.empty()&&(z=a.append("g").attr("class","y-axis").attr("transform","translate(800,0)")),z.transition().duration(1e3).call(k);const M=d3.axisRight(y).tickSize(800).tickValues(_).tickFormat("");a.append("g").attr("class","y grid").call(M),a.selectAll("text").style("font-family","Arial").style("font-zie","14px");const S=a.append("circle").attr("r",5).attr("fill","red").style("display","none"),A=a.append("text").attr("dy","-1em").style("text-anchor","middle").style("display","none"),B=a.append("line").attr("stroke","grey").attr("stroke-width","1").attr("stroke-dasharray","5,5").style("display","none");a.on("mouseover",(function(){S.style("display",null),A.style("display",null),B.style("display",null)})).on("mousemove",(function(t){const[e,a]=d3.pointer(t),s=c.invert(e),r=(0,d3.bisector((t=>new Date(t.timestamp))).left)(l,s),o=l[r];S.attr("cx",c(new Date(o.timestamp))).attr("cy",y(o.value)),B.attr("x1",c(new Date(o.timestamp))).attr("x2",c(new Date(o.timestamp))).attr("y1",y(u)).attr("y2",y(o.value)),A.attr("x",c(new Date(o.timestamp))).attr("y",y(o.value)-10).text(o.value).style("font-family","Roboto, Sans Serif").style("font-size","12px").style("font-weight","bold")})).on("mouseout",(function(){S.style("display","none"),A.style("display","none"),B.style("display","none")}))}},e=class{constructor(t){console.log(t),this.ticker=t,this.data=[30,80,45,60,121,90,15]}async get_data(){let t=this.url_maker();console.log(t);const e=await fetch(t),a=(await e.json())["Time Series (Daily)"];return Object.keys(a).map((t=>({timestamp:t,value:parseFloat(a[t]["1. open"])})))}url_maker(){return"https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol="+this.ticker.symbol+"&outputsize=full&apikey=XIW7BTPB24E0PU15"}generateRandomData(){const t=[],e=new Date;e.setHours(9,0,0,0);const a=new Date;a.setHours(17,0,0,0);for(let s=e;s<=a;s.setMinutes(s.getMinutes()+30)){const e=100*Math.random()+100;t.push({timestamp:s.toISOString(),value:e.toFixed(2)})}return t}},a=class{constructor(){const t=d3.select("#main");this.render(t)}render(t){t.style("height","90vh").style("width","70%").style("border","none").style("border-radius","1%").style("background-color","white").style("box-shadow","5px 5px 10px rgba(0, 0, 0, 0.5)");const e=t.append("div").attr("id","search_container").attr("position","relative").style("padding","20px").style("width","90%").style("height","10%").append("input").attr("id","search-input").attr("placeholder","Input your ticker to get started...").style("width","50%").style("border","1px solid grey").style("border-radius","15px").style("margin","20px 20px").style("font-size","20px").style("padding","10px 10px").style("box-shadow","5px 5px 10px rgba(0, 0, 0, 0.5)").style("text-transform","uppercase"),a=(t.append("div").attr("id","chart").style("height","80%").style("margin-top","25px").append("svg").attr("viewBox","0 0 800 400").attr("preserveAspectRatio","none").style("width","90%").style("height","75%").style("overflow","visible"),t.append("div").attr("id","footer").style("width","100%").style("background-color","beige").style("height","10%").style("border-top","2px solid grey"),d3.select("#footer").append("div").attr("id","links").style("margin-left","20px"));a.append("a").attr("id","github").attr("href","https://github.com/imnotbalaji").attr("target","_blank").append("img").attr("src","./images/github.png").style("width","25px"),a.append("a").attr("id","github").attr("href","https://www.linkedin.com/in/balajiv1/").attr("target","_blank").append("img").attr("src","./images/linked_in.png").style("width","25px");const s=d3.select("#footer").append("button").attr("id","Instructions").text("User Guide").style("margin-right","20px");let r=d3.select("#user-guide");s.on("click",(function(){r.style("display","block")})),d3.select(".close").on("click",(function(){r.style("display","none")})),d3.select(window).on("click",(function(t){console.log(t.target),console.log(r.node()),t.target==r.node()&&(console.log("window clicked"),r.style("display","none"))}));const o=this.test_search_ticker.bind(this),n=this.debounce(o,250);e.on("input",n)}debounce(t,e){let a;return s=>{clearTimeout(a),a=setTimeout((()=>t(s)),e)}}async test_search_ticker(t){if(""!==t.target.value){const e="https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords="+d3.select(t.target).property("value")+"&datatype=json&apikey=XIW7BTPB24E0PU15",a=await fetch(e),s=await a.json();this.render_search_dropdown(s.bestMatches)}else d3.select("#dropdown").attr("class","dropdown-hidden")}render_search_dropdown(t){d3.select("#dropdown").remove();const e=t.map((t=>({symbol:t["1. symbol"],name:t["2. name"]})));console.log(e),d3.select("#search_container").append("div").attr("id","dropdown").style("position","absolute").style("width","45%").style("background-color","white").attr("overflow-y","auto").style("margin-left","5px").style("margin-top","65px").style("padding","10px 10px").style("border","1px solid black").style("border-radius","15px").selectAll("div").data(e).enter().append("div").attr("id","dropdown-item").attr("width","30%").text((t=>`${t.symbol}      ${t.name}`)).on("click",((t,e)=>{d3.select("#search-input").property("value",e.symbol),console.log(e),this.render_chart_ticker(e)}))}render_chart_ticker(t){d3.select("#dropdown").remove();let a=d3.select("svg");const s=new e(t);this.render_chart(s,"All",a),this.show_zoom_buttons(s)}render_chart(e,a,s){new t(e,a,s)}show_zoom_buttons(t){let e=d3.select("#chart"),a=d3.select("svg");const s=["All","10Y","5Y","2Y","1Y","6M","3M","1M"];let r=s[0],o=d3.select("#zoom");o.empty()&&(o=e.append("div").attr("id","zoom"),o.append("img").attr("id","zoom-out").attr("src","./images/zoom_out.png").attr("width","25px").attr("height","25px"),o.append("span").attr("id","zoom_text"),o.append("img").attr("id","zoom-in").attr("src","./images/zoom_in.png").attr("width","25px").attr("height","25px"));let n=d3.select("#zoom-out");d3.select("#zoom_text").text(r),n.on("click",(()=>{r=s[s.indexOf(r)-1],d3.select("#zoom_text").text(r),this.render_chart(t,r,a)})),d3.select("#zoom-in").on("click",(()=>{r=s[s.indexOf(r)+1],d3.select("#zoom_text").text(r),this.render_chart(t,r,a)}))}},document.addEventListener("DOMContentLoaded",(()=>{d3.select("body").style("background-image","url('./images/island.png')"),new a}))}();
//# sourceMappingURL=main.js.map